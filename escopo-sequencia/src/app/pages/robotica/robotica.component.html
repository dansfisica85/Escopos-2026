<div class="page-container">
  <a href="https://fiapcom-my.sharepoint.com/:p:/g/personal/thais_pianucci_alura_com_br/IQBdW2nvEaO_RIkfEUndp_0uAfRrnVZ92W52CtqJOCR_Xqo?rtime=XjfzVkln3kg" target="_blank" class="materiais-didaticos-btn">
    ğŸ“š MATERIAIS DIDÃTICOS
  </a>
  <div class="filters">
    <div class="filter-group">
      <label>Ciclo</label>
      <select (change)="onDisciplinaChange(+$any($event.target).value)">
        @for (d of disciplinas; track d.id; let i = $index) {
          <option [value]="i" [selected]="d.id === selectedDisciplina().id">RobÃ³tica â€” {{ d.ciclo }}</option>
        }
      </select>
    </div>
    <div class="filter-group">
      <label>Ano/SÃ©rie</label>
      <select (change)="onAnoChange(+$any($event.target).value)">
        @for (a of anos(); track a.anoSerie; let i = $index) {
          <option [value]="i" [selected]="a.anoSerie === selectedAno().anoSerie">{{ a.anoSerie }}</option>
        }
      </select>
    </div>
    <div class="filter-group">
      <label>Bimestre</label>
      <select (change)="onBimestreChange(+$any($event.target).value)">
        @for (b of bimestres(); track b.bimestre; let i = $index) {
          <option [value]="i" [selected]="b.bimestre === selectedBimestre().bimestre">{{ b.bimestre }}</option>
        }
      </select>
    </div>
  </div>

  @if (materiaisAtuais(); as mat) {
    <div class="materiais-section">
      <h3>ğŸ“ Materiais de Apoio â€” {{ mat.ano }}</h3>
      <div class="materiais-grid">
        @for (m of mat.materiais; track m.aula) {
          <a [href]="m.link" target="_blank" class="material-link">
            <span class="material-aula">Aula {{ m.aula }}</span>
            <span class="material-titulo">{{ m.titulo }}</span>
            <span class="material-icon">ğŸ“„</span>
          </a>
        }
      </div>
    </div>
  }

  <h2 class="section-title">
    {{ selectedDisciplina().nome }} â€” {{ selectedAno().anoSerie }} â€” {{ selectedBimestre().bimestre }}
  </h2>

  <div class="semanas-list">
    @for (semana of semanas(); track semana.numero) {
      <div class="semana-card" [class.expanded]="expandedSemana() === semana.numero" [class.especial]="!!semana.especial">
        <div class="semana-header" (click)="toggleSemana(semana.numero)">
          <div class="semana-info">
            <span class="semana-numero">Semana {{ semana.numero }}</span>
            @if (semana.data) {
              <span class="semana-data">{{ semana.data }}</span>
            }
            @if (semana.especial) {
              <span class="semana-especial-badge">{{ semana.especial }}</span>
            }
            @if (semana.unidade) {
              <span class="semana-unidade">{{ semana.unidade }}</span>
            }
            @if (getMaterialLink(semana.numero)) {
              <a [href]="getMaterialLink(semana.numero)" target="_blank" class="material-badge" (click)="$event.stopPropagation()">ğŸ“„ Material</a>
            }
          </div>
          <span class="expand-icon">{{ expandedSemana() === semana.numero ? 'â–²' : 'â–¼' }}</span>
        </div>

        @if (expandedSemana() === semana.numero) {
          <div class="semana-content">
            @if (getMaterialLink(semana.numero); as link) {
              <a [href]="link" target="_blank" class="material-download-link" (click)="$event.stopPropagation()">
                ğŸ“„ Abrir Material Digital â€” Aula {{ semana.numero }}
              </a>
            }
            @if (semana.especial && semana.aulas.length === 0) {
              <div class="especial-message">
                <span class="especial-icon">ğŸ“‹</span>
                <p>{{ semana.especial }}</p>
              </div>
            }
            @for (aula of semana.aulas; track aula.aulaSala) {
              <div class="aula-card">
                <div class="aula-header">
                  <h4>{{ aula.aulaSala }} â€” {{ aula.titulo }}</h4>
                  <div class="aula-badges">
                    @if (aula.formato) {
                      <span class="badge formato">{{ aula.formato }}</span>
                    }
                    @if (aula.entregaProjeto) {
                      <span class="badge entrega">ğŸ“¦ Entrega</span>
                    }
                  </div>
                </div>
                @if (aula.materialLink) {
                  <a [href]="aula.materialLink" target="_blank" class="material-download-link">
                    ğŸ“„ Abrir Material Digital â€” {{ aula.titulo }}
                  </a>
                }
                <div class="aula-details">
                  <div class="detail-section">
                    <h5>ğŸ¯ Objetivos</h5>
                    <p>{{ aula.objetivos }}</p>
                  </div>
                  <div class="detail-section">
                    <h5>ğŸ“– ConteÃºdos</h5>
                    <p>{{ aula.conteudos }}</p>
                  </div>
                </div>
              </div>
            }
          </div>
        }
      </div>
    }
  </div>
</div>
